jQuery.fn.stalker=function(){AJS.log("DEPRECATED: jQuery.fn.stalker - See https://studio.atlassian.com/browse/AJS-676");function B(){return parseInt(jQuery.browser.version.replace(/\.*/g,"").substring(0,3),10)}function A(){var C=jQuery.browser.version.replace(/\.*/g,"").substring(0,3);return jQuery.browser.mozilla&&C<192}return function(){var G,K,F,M,L,P,H,N,O,I,E=!(jQuery.browser.msie&&jQuery.browser.version<7||(!jQuery.os.mac&&B()<191));function J(){F=jQuery(I),L=F.offset().top,M=F.prevAll(":visible");function T(){F.css("overflow","hidden");N=F.height();F.css("overflow","")}function U(){P=jQuery("<div />").addClass("stalker-placeholder").css({visibility:"hidden",height:N}).insertBefore(F)}function S(){if(!F.hasClass("detached")){P.height(F.height())}else{P.height(F.removeClass("detached").height());F.addClass("detached")}}T();U();S();F.css(R());F.bind("stalkerHeightUpdated",S);F.bind("positionChanged",C);if(A()){F.addClass("fix-ff35-flicker")}O=true}function R(){if(jQuery.os.windows||jQuery.os.linux){return{position:"absolute",top:L}}else{return{position:"fixed",top:L-G.scrollTop()}}}function C(){function S(){var T=1-G.scrollTop()/L;if(T>1){return""}else{if(T<0){return 0}else{return T}}}if(!O){J()}M.css("opacity",S());if(L<=G.scrollTop()){if(!F.hasClass("detached")){F.css({top:0,position:"fixed"}).addClass("detached")}}else{F.css(R()).removeClass("detached")}H=G.scrollTop()}function D(){function T(W){var V=jQuery.getDocHeight(),X;if(W>=0&&W<=V){X=W}else{if(W>=G.scrollTop()){X=V}else{if(W<0){X=0}}}G.scrollTop(X)}function S(){if(!O){J()}var V=jQuery(window).scrollTop()-jQuery(window).height();T(V+N)}function U(){if(!O){J()}var V=jQuery(window).scrollTop()+jQuery(window).height();T(V-N)}jQuery(function(){K.bind("keydown keypress keyup","pagedown",function(V){if(V.type==="keydown"){U()}V.preventDefault()});K.bind("keydown keypress keyup","pageup",function(V){if(V.type==="keydown"){S()}V.preventDefault()});K.bind("keydown keypress keyup","space",function(V){if(V.type==="keydown"){U()}V.preventDefault()});K.bind("keydown keypress keyup","shift+space",function(V){if(V.type==="keydown"){S()}V.preventDefault()})})}function Q(){K.bind("showLayer",function(W,U,V){var T,S;if(!O){J()}if(U==="dropdown"&&V.$.parents(I).length!==-1){T=(F.hasClass("detached")?0:F.offset().top);S=jQuery(window).height()-F.height()-T;if(S<=parseInt(V.$.attr("scrollHeight"),10)){AJS.containDropdown.containHeight(V,S)}else{AJS.containDropdown.releaseContainment(V)}V.reset();if(A()){F.height(F.attr("scrollHeight"))}}}).bind("hideLayer",function(){if(A()){F.height("")}})}if(!E){return }G=jQuery(window);K=jQuery(document);I=this.selector;D();Q();K.click(function(S){if(jQuery(S.target).parents(I).length!==0&&!O){J()}});K.bind("showLayer",function(T,S){if(M){M.css("opacity","")}if(jQuery.browser.mozilla&&S==="popup"){C()}});jQuery(".stalker-placeholder, "+this.selector).offsetAnchors();G.scroll(C).resize(function(){if(F){F.trigger("stalkerHeightUpdated")}});K.mouseup(function(){if(H&&G.scrollTop()===H){M.css("opacity","   ")}});return this}}();